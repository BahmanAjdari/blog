---
title: وارد کردن همزمان چندین فایل اکسل به محیط R
author: بهمن اجدری
date: '2020-11-30'
slug: []
categories:
  - R
tags:
  - Import Data
---
# خواندن چندین فایل در R
نرم‌افزار اکسل یکی از محیط‌های محبوب برای ثبت و مگهداری داده‌های خام می‌باشد. در موارد متعددی لازم است تعداد فراوانی از فایل‌های اکسل به محیط R فراخوانی شود. برای نمونه ممکن است در کامپیوتر خود پوشه‌ای را داشته باشید که حاوی تعداد فراوانی از فایل‌های اکسل باشد. به شکل زیر دقت کنید.

![files_screen](/images/files_screen.png)
فرض کنید می‌خواهیم تمام فایل‌های نمایش داده شده را وارد محیط برنامه‌نویسی R کنیم. ممکن اولین راه حلی که به ذهن می‌رسد استفاده از روش معمول و وارد کردن تک تک فایل‌ها باشد. اما این روش وقتی تعداد فایل‌ها زیاد باشد خیلی عاقلانه بنظر نمی‌رسد.

خواندن چندین فایل بصورت همزمان در R

برای خواندن چندین فایل بصورت همزمان کافی است قدم‌های زیر را انجام دهیم:

1. فراخوانی کتابخانه‌های مورد نیاز
2.درست کردن لیستی از اسامی فایل‌ها
3. وارد کردن فایل‌ها به Rstudio

# فراخوانی کتابخانه‌های مورد نیاز

ابتدا کتابخانه‌های زیر را فراخوانی میکنیم. اگر قبلاً آن‌ها را نصب نکرده‌اید لازم است با دستور `install.packages` آن‌ها را نصب کنید.

```
library(tidyverse)
library(readxl)
library(data.table)
```
حالا محل فایل‌های خود را باید به R  معرفی کنید. منطق مار به این صورت است که R به دنبال فایلهایی با پسوند مشخص در محل مورد نظر می‌گردد و لیستی از آن‌ها تهیه میکند. در این مثال محل مورد نظر پوشه‌ای بنام files است. شما به تناسب محل قرارگیری فایل‌های خود میتوانید آدرس dir را تغییر دهید.

```
setwd(dir= ~/data_for_viz/files)

```
حالا بوسیله دستور زیر لیستی از فایل‌های درون پوشه مورد نظر را ایجاد میکنیم.

```
file.list <- list.files(pattern=”.xlsx”)

```
حالا R منتظر است بداند که با لیست ایجاد شده چکار باید بکند. با دستور ```lapply``` فرمان اجرای ```read_excel``` را برای تمام لیست صادر میکنیم.

```
df.files <- lapply(file.list, read_excel)

```
حالا در ```df.files```  محتویات تمام فایل‌های اکسل را داریم. اگر ستون‌های موجود در هر فایل اکسل یکسان باشد میتوانیم از دستور ```bind_rows()``` برای ترکیب آن‌ها استفاده کنیم.

```
df<- bind_rows(df.files)

```


